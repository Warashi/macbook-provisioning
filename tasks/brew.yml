- hosts: localhost
  connection: local
  gather_facts: no
  vars_files:
    - "../vars/brew.yml"
  tasks:
    - name: brew パッケージをインストール
      homebrew: >
        name={{ item.name }}
        state={{ item.state | default('latest') }}
        install_options={{
          item.install_options | default() | join(',')
          if item.install_options is not string
          else item.install_options
        }}
      with_items: "{{ homebrew_packages }}"

    - name: start brew services
      command: "brew services start {{ item }}"
      with_items: "{{ homebrew_services }}"
